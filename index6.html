<!DOCTYPE html>
<html lang="en">
	<head>
		<title>fxxxlocsdsking</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				background-color: #ffffff;
				margin: 0px;
				overflow: hidden;
				font-family: sans-serif;
			}

			a {
				color:#0078ff;
			}

			#info {
				color: #000;
				position: absolute;
				top: 10px;
				width: 100%;
			}

			#container {
				position: relative;
				max-width: 90%;
				z-index: 10;
				background: red;
				opacity: 1;
			}

			.text {
				z-index: 0;
				font-size: 2em;
				color: black;
				position: absolute;
				opacity: 1;
				right: 20vw;
				top: 15vw;
				max-width: 400px;
			}
		</style>
	</head>
	<body>

		<div id="container"></div>

		<script src="js/three.min.js"></script>
		<script id="vertexShader" type="x-shader/x-vertex">
			void main() {
				gl_Position = vec4( position, 1.0 );
			}
		</script>




		################################################################################################################################################




		<script id="fragmentShader" type="x-shader/x-fragment">
			uniform vec2 u_resolution;
			uniform sampler2D u_texture_1;
			uniform sampler2D u_texture_1i;
			uniform sampler2D u_texture_2;
			uniform sampler2D u_texture_3;
			uniform sampler2D u_texture_3i;
			uniform sampler2D u_texture_4;
			uniform float u_loop_1;
			uniform float u_loop_2;
			uniform float u_loop_3;
			uniform float u_loop_4;
			uniform bool u_loop_1_running;
			uniform bool u_loop_2_running;
			uniform vec2 st;
			uniform vec2 u_fragcoord;

			void main() {
				float amplitude = 100.;
				float frequency = 5.0;

				vec2 st = gl_FragCoord.st/u_resolution.xy;

				// colors:
				// blue					0.049, 0.055, 0.352
				// purple 			0.179, 0.013, 0.333
				// red 					0.918, 0.202, 0.165
				// light-gray		0.784, 0.788, 0.796

				vec3 pattern_1 = vec3(0.6);
				vec3 pattern_1i = vec3(0.6);
				vec3 pattern_2 = vec3(0.6);
				vec3 rothko_1 = vec3(0.6);
				vec3 rothko_1i = vec3(0.6);
				vec3 rothko_2	 = vec3(0.6);

				vec4 texture_1 = texture2D(u_texture_1, st);
				vec4 texture_1i = texture2D(u_texture_1i, st);
				vec4 texture_2 = texture2D(u_texture_2, st);
				vec4 texture_3 = texture2D(u_texture_3, st);
				vec4 texture_3i = texture2D(u_texture_3i, st);
				vec4 texture_4 = texture2D(u_texture_4, st);

				pattern_1 += texture_1.xyz;
				pattern_1i += texture_1i.xyz;
				pattern_2 += texture_2.xyz;
				rothko_1 += texture_3.xyz;
				rothko_1i += texture_3i.xyz;
				rothko_2 += texture_4.xyz;

				vec3 print = vec3(0.6);
				vec3 layer_1 = abs(pattern_1 - rothko_1);
				vec3 layer_2 = abs(pattern_2 - rothko_2);

				vec3 layer_x = abs(pattern_1 - rothko_1);
//				vec3 layer_a = abs(pattern_1i - rothko_1i);
				vec3 layer_y = abs(pattern_2 - rothko_2);

				if(u_loop_1_running) {
					if( all(greaterThan(layer_1, vec3(u_loop_1)))) {
						layer_1 = vec3(0.0);
					} else {
						layer_1 = vec3(1.0);
					}
				}

				if(u_loop_1_running) {
					if( all(greaterThan(layer_2, vec3(u_loop_2)))) {
						layer_2 = vec3(0.0);
					} else {
						layer_2 = vec3(1.0);
					}
				}

				if(u_loop_1_running) {
					if( all(greaterThan(layer_x, vec3(u_loop_3)))) {
						layer_x = vec3(0.0);
					} else {
						layer_x = vec3(1.0);
					}
				}

				if(u_loop_1_running) {
					if( all(greaterThan(layer_y, vec3(u_loop_4)))) {
						layer_y = vec3(0.0);
					} else {
						layer_y = vec3(1.0);
					}
				}

				print = layer_1 * layer_x * layer_2 * layer_y;

				vec4 texture = vec4(print, 1.0);
				gl_FragColor = texture;
			}
		</script>


		################################################################################################################################################



    <script>
				let container;
				let canvas;
        let camera, scene, renderer;
				let uniforms;
				let offset = 0.0;
				let days = 1.0;
				let loop_1 = 0.0;
				let loop_2 = 0.0;
				let loop_1_running = true;
				let loop_2_running = true;

        init();
				animate();

        function init() {
					renderer = new THREE.WebGLRenderer();
					renderer.setClearColor(1.0, 1.0, 1.0, 0.0);
					renderer.setPixelRatio( window.devicePixelRatio );

					container = document.getElementById( 'container' );
					container.appendChild( renderer.domElement );

          camera = new THREE.Camera();
          camera.position.z = 1;

					scene = new THREE.Scene();

          const geometry = new THREE.PlaneBufferGeometry( 2, 2 );

					const loader = new THREE.TextureLoader()

					const texture1 = loader.load( './img/ddd3.jpg' );
					const texture1i = loader.load( './img/ddd3i.jpg' );
					const texture2 = loader.load( './img/bb2.jpg' );
					const texture3 = loader.load( './img/rothko.jpg' );
					const texture3i = loader.load( './img/rothko_i.jpg' );
					const texture4 = loader.load( './img/rothko3.jpg' );

          uniforms = {
						u_loop_1: { type: "f", value: 1.0 },
						u_loop_2: { type: "f", value: 1.0 },
						u_loop_3: { type: "f", value: 1.0 },
						u_loop_4: { type: "f", value: 1.0 },
						u_loop_1_running: { type: "b", value: false },
						u_loop_2_running: { type: "b", value: false },
						u_resolution: { type: "v2", value: new THREE.Vector2() },
						u_texture_1: { type: "t", value: texture1 },
						u_texture_1i: { type: "t", value: texture1i },
						u_texture_2: { type: "t", value: texture2 },
						u_texture_3: { type: "t", value: texture3 },
						u_texture_3i: { type: "t", value: texture3i },
						u_texture_4: { type: "t", value: texture4 },
						u_fragcoord: { type: "v2", value: new THREE.Vector2() }
					};

          const material = new THREE.ShaderMaterial({
						uniforms: uniforms,
						vertexShader: document.getElementById( 'vertexShader' ).textContent,
						fragmentShader: document.getElementById( 'fragmentShader' ).textContent,
						transparent: true,
						opacity: 0,
					});

					const mesh = new THREE.Mesh(geometry, material);

					scene.add(mesh);

				  onWindowResize();
					window.addEventListener('resize', onWindowResize, false);
				}

				const textCanvas = document.createElement('canvas');
				loadSVG('img/text.svg',canvas);

				function loadSVG(file,canvas){
					var svg=new Image();
					svg.addEventListener('load',function(){
						var ctx=textCanvas.getContext('2d');
						textCanvas.width=svg.width;
						textCanvas.height=svg.height;
						ctx.drawImage(svg,0,0);
					})
					svg.src=file;
				}

        function onWindowResize(event) {
					renderer.setSize(window.innerWidth, window.innerHeight);
					uniforms.u_resolution.value.x = renderer.domElement.width;
					uniforms.u_resolution.value.y = renderer.domElement.height;
        }

        function animate() {
					requestAnimationFrame(animate);
					render();
				}


//		################################################################################################################################################


        function render() {
					loop_1_running && (loop_1 += 0.01);

					offset = Math.PI/2;

					loop_1_curve = Math.sin(loop_1);
					loop_2_curve = Math.sin(loop_1 + offset);
					loop_3_curve = Math.sin(loop_1 + 2*(offset));
					loop_4_curve = Math.sin(loop_1 + 3*(offset));

					function normalize(val, max, min) {
						return (val - min) / (max - min);
					}

					function customNormalize(x, minX, maxX, minV, maxV) {
						return (maxV-minV) * ((x - minX) /( maxX - minX)) + minV
					}

					console.log(customNormalize(loop_1_curve, 1, -1, 0.3, 0.5))

					shortLoop_1 = normalize(loop_1_curve, 1, -1)
					shortLoop_2 = normalize(loop_2_curve, 1, -1)
					shortLoop_3 = normalize(loop_3_curve, 1, -1)
					shortLoop_4 = normalize(loop_4_curve, 1, -1)

					//		console.log(shortLoop_1,shortLoop_2 )

					uniforms.u_loop_1.value = shortLoop_1; // adjusts loop speed
					uniforms.u_loop_2.value = shortLoop_2; // adjusts loop speed
					uniforms.u_loop_3.value = shortLoop_3; // adjusts loop speed
					uniforms.u_loop_4.value = shortLoop_4; // adjusts loop speed
					uniforms.u_loop_1_running.value = loop_1_running;
					uniforms.u_loop_2_running.value = loop_2_running;

					renderer.render( scene, camera );
        }
    </script>
	</body>
</html>
